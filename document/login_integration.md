# 登录注册系统集成说明

## 概述

本文档说明了如何在AuraLab Flutter应用中集成Go后端的登录注册系统。

## 已实现功能

### 1. 后端API对接
- ✅ 用户注册功能
- ✅ 用户登录功能
- ✅ 网络请求错误处理
- ✅ 加载状态显示

### 2. 前端界面
- ✅ 登录/注册表单
- ✅ 表单验证
- ✅ 密码显示切换
- ✅ 加载状态指示器
- ✅ 错误消息显示

### 3. 用户状态管理
- ✅ 用户登录状态保存
- ✅ 用户信息管理
- ✅ 登出功能
- ✅ 抽屉中显示用户状态

## 文件结构

```
lib/
├── models/
│   └── user_model.dart          # 用户数据模型
├── services/
│   ├── api_service.dart         # API请求服务
│   └── user_service.dart        # 用户状态管理
├── screens/
│   ├── user/
│   │   └── user.dart           # 登录注册页面
│   └── drawer/
│       └── drawer.dart         # 侧边栏（已更新）
└── routes/
    └── app_routes.dart         # 路由配置
```

## 使用说明

### 1. 启动后端服务

确保Go后端服务正在运行：
```bash
cd path/to/backend
go run main.go
```

后端服务将在 `http://localhost:8000` 启动。

### 2. 安装依赖

确保在 `pubspec.yaml` 中添加了必要的依赖：
```yaml
dependencies:
  http: ^1.1.0
```

运行以下命令安装依赖：
```bash
flutter pub get
```

### 3. 使用登录注册功能

1. **访问登录页面**：点击侧边栏中的头像
2. **注册新用户**：
   - 输入用户名（至少3个字符）
   - 输入邮箱（仅注册时需要）
   - 输入密码（至少6个字符）
   - 确认密码
   - 点击"注册"按钮
3. **登录**：
   - 输入用户名
   - 输入密码
   - 点击"登录"按钮
4. **登出**：在侧边栏底部点击"退出登录"按钮

### 4. 用户状态显示

- **未登录状态**：侧边栏显示"点击登录"
- **已登录状态**：侧边栏显示用户名和登出按钮

## API接口说明

### 注册接口
```
POST /api/auth/register
Content-Type: application/json

{
    "username": "用户名",
    "password": "密码"
}
```

### 登录接口
```
POST /api/auth/login
Content-Type: application/json

{
    "username": "用户名",
    "password": "密码"
}
```

### 响应格式
```json
{
    "success": true/false,
    "message": "操作结果消息",
    "user": {
        "id": 1,
        "username": "用户名",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z",
        "is_active": true
    }
}
```

## 错误处理

系统会处理以下错误情况：
- 网络连接失败
- 用户名已存在（注册时）
- 用户名或密码错误（登录时）
- 用户账户未激活
- 服务器内部错误

## 安全特性

1. **密码加密**：后端使用bcrypt进行密码哈希
2. **输入验证**：前端进行表单验证
3. **错误处理**：不暴露敏感信息
4. **状态管理**：安全的用户状态管理

## 待优化功能

1. **本地存储**：实现用户信息的本地持久化存储
2. **JWT令牌**：添加JWT令牌认证
3. **忘记密码**：实现密码重置功能
4. **用户头像**：支持用户头像上传和显示
5. **自动登录**：应用启动时自动检查登录状态

## 注意事项

1. 确保后端服务正在运行
2. 检查网络连接
3. 后端数据库需要正确配置
4. 生产环境中需要使用HTTPS
5. 考虑添加更多的安全验证

## 故障排除

### 常见问题

1. **网络连接失败**
   - 检查后端服务是否启动
   - 确认API地址是否正确
   - 检查防火墙设置

2. **注册失败**
   - 检查用户名是否已存在
   - 确认密码长度符合要求
   - 检查数据库连接

3. **登录失败**
   - 确认用户名和密码正确
   - 检查用户账户是否激活
   - 确认后端服务正常

## 开发者说明

如需修改API地址，请编辑 `lib/services/api_service.dart` 文件中的 `baseUrl` 常量。

```dart
static const String baseUrl = 'http://your-backend-url:port/api';
```